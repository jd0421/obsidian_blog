---
{"dg-publish":true,"permalink":"/public/course/course-datarian/course-datarian//","tags":["CASE","Window"],"created":"2025-08-26T15:00:21.025+09:00","updated":"2025-08-29T16:08:45.865+09:00"}
---

https://solvesql.com/problems/estimate-penguin-mass/
is not null 은 그대로, null 은 윈도우 함수로 출력



```mysql

-- 같은 종, 같으 서식지 펭귄 몸무게의 평균 값

  

with step1 as (

  select

    species

    , island

    , body_mass_g

    , round(case when body_mass_g is not null then body_mass_g else avg(body_mass_g) over(partition by species, island) end, 2) as `estimated_body_mass_g`

  from penguins

)

select *

from step1

order by

  1 asc

  , 2 asc

  , estimated_body_mass_g desc

;
```