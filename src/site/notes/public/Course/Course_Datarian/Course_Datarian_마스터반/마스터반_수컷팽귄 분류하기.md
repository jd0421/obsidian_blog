---
{"dg-publish":true,"permalink":"/public/course/course-datarian/course-datarian//","tags":["CASE"],"created":"2025-08-26T14:34:46.376+09:00","updated":"2025-08-29T16:08:45.846+09:00"}
---

https://solvesql.com/problems/heavy-male-penguin/

분기열 먼전 만들고 그 다음 집계

```mysql
select

  case

    when body_mass_g > (select avg(body_mass_g) from penguins where sex = 'Male') then 1

    when body_mass_g < (select avg(body_mass_g) from penguins where sex = 'Male') then -1

  end as `compare_avg`

  , count(*) as cnt

from penguins

where sex = 'Male'

group by 1

```