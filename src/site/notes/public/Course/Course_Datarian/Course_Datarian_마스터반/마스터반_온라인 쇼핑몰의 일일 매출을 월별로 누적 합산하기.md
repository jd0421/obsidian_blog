---
{"dg-publish":true,"permalink":"/public/course/course-datarian/course-datarian//","tags":["누적합","Extract"],"created":"2025-08-26T16:06:00.628+09:00","updated":"2025-08-29T16:08:45.947+09:00"}
---


https://solvesql.com/problems/monthly-cumulative-sales/

- 2차
```mysql
  
with step1 as (

  select

    orders.order_id

    , orders.order_date

    , orders.customer_id

    -- , order_items.*

    , order_items.price * order_items.quantity as total_price

  FROM orders

    left join order_items on orders.order_id = order_items.order_id

  where orders.order_date between '2018-12-01' and '2019-01-31'

)

, step2 as (

  select

    order_date

    , SUM(total_price) as daily_sales

    -- , DENSE_RANK() over(partition by date_format(order_date, '%Y-%m') ORDER BY date_format(order_date, '%Y-%m') ASC)

  from step1

  group by 1

  order by 1

)

  

select

  *

  , SUM(daily_sales) OVER(PARTITION BY EXTRACT(year_month from order_date) ORDER BY order_date) as monthly_cum_sum

from step2

;
```

- 1차
```mysql
  

with step1 as (

  select

    orders.order_id

    , orders.order_date

    , orders.customer_id

    -- , order_items.*

    , order_items.price * order_items.quantity as total_price

  FROM orders

    left join order_items on orders.order_id = order_items.order_id

  where orders.order_date between '2018-12-01' and '2019-01-31'

)

  

select

  order_date

  -- , SUM(total_price) as daily_sales

  , DENSE_RANK() over(partition by date_format(order_date, '%Y-%m') ORDER BY date_format(order_date, '%Y-%m') ASC)

from step1

-- group by 1

-- order by 1

limit 10

;

  
  
  

-- select *

-- FROM order_items

-- limit 10 ;
```