---
{"dg-publish":true,"permalink":"/public/course/course-datarian/course-datarian//","created":"2025-08-26T14:48:00.847+09:00","updated":"2025-08-29T16:08:45.830+09:00"}
---


https://solvesql.com/problems/more-finedust-than-yesterday/
where 절에서는 윈도우 함수를 그대로 사용 불가, cte 함수로 돌려서 사용


```mysql
  

with step1 as (

  select

    measured_at

    , pm10

    , lag(measured_at, 1) over(order by measured_at) as measured_at_lag

    , lag(pm10, 1) over(order by measured_at) as pm10_lag

    , pm10 - lag(pm10, 1) over(order by measured_at) as `diff pm10`

  from measurements

)

  

select

  measured_at

  , pm10

  , `diff pm10`

from step1

where `diff pm10` >= 100

order by measured_at asc

;
```