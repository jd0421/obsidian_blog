---
{"dg-publish":true,"permalink":"/public/course/course-datarian//","tags":["CTE함수","Window"],"created":"2025-08-27T15:09:52.291+09:00","updated":"2025-08-29T16:08:46.236+09:00"}
---

https://solvesql.com/problems/bad-finedust-measure/


```mysql
  

with step1 as (

  select

    measured_at

    , pm10

    , lead(measured_at) over(order by measured_at) as measured_at_lead

    , lead(pm10) over(order by measured_at) as pm10_lead

  from measurements

)

  

select

  measured_at as `today`

  , measured_at_lead as `next_day`

  , pm10 as `pm10`

  , pm10_lead as `next_pm10`

from step1

where pm10 < pm10_lead

;
```