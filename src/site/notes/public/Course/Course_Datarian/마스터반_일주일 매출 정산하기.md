---
{"dg-publish":true,"permalink":"/public/course/course-datarian//","tags":["CASE"],"created":"2025-08-26T14:26:14.530+09:00","updated":"2025-08-29T16:08:45.813+09:00"}
---

https://solvesql.com/problems/summary-of-weekly-sales/
`time` 컬럼의 값이 ‘Lunch’인 경우 ‘점심 매출’, ‘Dinner’인 경우 ‘저녁 매출’입니다.
```postgresql
select

  day as "요일"

  , case when sum(case when time = 'Lunch' then total_bill end) != 0 then sum(case when time = 'Lunch' then total_bill end) else 0 end as "점심 매출"

  , case when sum(case when time = 'Dinner' then total_bill end) != 0 then sum(case when time = 'Dinner' then total_bill end) else 0 end as "저녁 매출"

from tips

group by 1

order by 3 DESC
```