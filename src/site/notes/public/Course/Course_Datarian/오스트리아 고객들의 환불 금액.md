---
{"dg-publish":true,"permalink":"/public/course/course-datarian//","created":"2025-08-29T15:37:44.979+09:00","updated":"2025-08-29T16:08:46.766+09:00"}
---


https://solvesql.com/problems/refund-austria/

지역 조건
환불 거래 제외 조건

```mysql
-- 오스트리 고객들의 총 환불 금액

  

with step1 as (

  select *

  from customers

  where country = 'Austria'

)

  

-- select *

-- from step1

-- limit 10

  

select

  abs(sum(order_items.price * order_items.quantity)) as `refund_austria`

from orders

  inner join step1 on orders.customer_id = step1.customer_id

  inner join order_items on orders.order_id = order_items.order_id

where orders.order_id like 'C%'

  

limit 10

  

;
```